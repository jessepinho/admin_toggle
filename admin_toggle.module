<?php

/**
 * @file
 * Module file for the Admin Toggle module.
 */

/**
 * Implements hook_init().
 */
function admin_toggle_init() {
  if (user_access('use admin toggle')) {
    $settings = array(
      'adminToggle' => array(
        'key' => variable_get('admin_toggle_key', '`'),
        'selector' => admin_toggle_get_selector(),
      ),
    );
    drupal_add_js($settings, 'setting');
    drupal_add_js(drupal_get_path('module', 'admin_toggle') . '/admin_toggle.js');
  }
}

/**
 * Implements hook_permission().
 */
function admin_toggle_permission() {
  return array(
    'use admin toggle' => array(
      'title' => t('Use Admin Toggle'),
      'description' => t('Use Admin Toggle functionality.'),
    ),
    'administer admin toggle' => array(
      'title' => t('Administer Admin Toggle'),
      'description' => t('Modify settings for Admin Toggle.'),
    ),
  );
}

/**
 * Return the jQuery selector for admin elements to toggle.
 */
function admin_toggle_get_selector() {
  // Build an array of selectors.
  $selectors = array();
  $selectors[] = variable_get('admin_toggle_custom_selector');
  return implode(',', $selectors);
}
